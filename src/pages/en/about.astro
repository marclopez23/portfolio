---
// src/pages/sobre-mi.astro
import PageLayout from '../../layouts/PageLayout.astro';
import Hero from '../../components/Hero.astro';
import Title from '../../components/Title.astro';
import Punto from '../../components/Punto.astro';
import RecommendationLetter from '../../components/RecommendationLetter.astro';

const pageTitle = "Sobre mí - Marc López";

// Datos de los puntos "Como trabajo"
const misValoresItems = [
  {
    number: "1",
    title: "Transparency",
    description: "I believe in open and honest communication.\nI prefer to say things as they are, both when something works and when there are problems to solve."
  },
  {
    number: "2", 
    title: "Respect",
    description: "I deeply value the ideas and work of every team member. Everyone has something valuable to contribute, regardless of their role or experience."
  },
  {
    number: "3",
    title: "Purpose", 
    description: "I don’t settle for making things beautiful just for the sake of it. What I design must have real meaning and improve the lives of the people who are going to use it."
  },
  {
    number: "4",
    title: "Growth",
    description: "I believe there is always something new to learn and improve. I enjoy growing as a professional and helping the team grow as well."
  },
  {
    number: "5",
    title: "Balance",
    description: "I aim to find the point where user needs, technical possibilities, and business objectives meet. That’s where the best solutions are born."
  },
  {
    number: "6",
    title: "Accessibility",
    description: "Good design works for everyone, regardless of their abilities or context. It’s not just about meeting standards, but about creating experiences that truly include everyone."
  }
];


// Datos de los puntos "Qué aporto"
const queAportoItems = [
  {
    title: "Design-Development connection",
    description: "I know the possibilities and understand the technical limitations, which allows me to create designs that work in practice."
  },
  {
    title: "Adaptability in challenging situations", 
    description: "When unexpected issues or scope changes arise, my first reaction is to analyze the real impact and look for alternatives."
  },
  {
    title: "Collaborative spirit",
    description: "I believe the best ideas come from exchange. I like involving the whole team in the design process."
  },
  {
    title: "Knowledge sharing",
    description: "If I discover something useful, I don’t keep it to myself. I believe a team that learns together is an unstoppable team."
  }
];


// Datos de las cartas de recomendación
const recomendacionItems = [
  {
    nombre: "Mauricio Alpizar",
    cargo: "Senior Product Designer",
    empresa: "K-LAGAN",
    href: "/assets/cartas/carta-mau.pdf",
    linkText: "Reed recommendation letter"
  },
  {
    nombre: "Eszter Vass",
    cargo: "Principal Product Management in Custody Banking",
    empresa: "Epsom", 
    href: "/assets/cartas/carta-eszter.pdf",
    linkText: "Reed recommendation letter"
  }
];


function getUrl(path: string): string {
  if (!path) return '#';
  const base = import.meta.env.BASE_URL;
  const cleanPath = path.startsWith('/') ? path.slice(1) : path;
  const baseWithSlash = base.endsWith('/') ? base : base + '/';
  return `${baseWithSlash}${cleanPath}`;
}
---

<PageLayout 
  title="About Me - Marc López"
  currentPage="about"
  description="Learn more about Marc López"
  lang="en"
>

  <!-- Hero Section -->
  <section role="banner" aria-labelledby="hero-title">
      <Hero 
        title="About Me"
        titleTag="h1"
        class="fade-in"
        id="hero-title"
      />
  </section>

  <!-- Intro Section -->
  <section 
    class="section section--with-border" 
    id="intro"
    role="main"
    aria-labelledby="intro-heading"
  >
    <div class="container">
  <!-- Invisible heading for screen readers -->
  <h2 id="intro-heading" class="sr-only">Personal Introduction</h2>
  
  <div class="text-columns">
    <!-- Left column -->
    <div class="intro-text" role="region" aria-label="Work Philosophy">
      <p class="paragraph">
        I’m Marc, a Product Designer with experience in the <span class="intro-highlight">creation and management of complex digital products</span>, always with a focus on collaboration and continuous improvement. 
      </p>
      <p class="paragraph">
        I’m passionate about <span class="intro-highlight">designing clear and useful experiences</span>, but also about exploring new ways of working: dynamics, processes, and tools that make teams more efficient and creative.
      </p>
      <p class="paragraph">
        I work closely with <span class="intro-highlight">research, data, business, and technology teams</span>, which allows me to approach projects with a comprehensive vision. In addition, my knowledge of web development helps me better understand technical limitations and opportunities, and collaborate more smoothly with development teams.
      </p>
    </div>
    
    <!-- Right column -->
    <div class="intro-text" role="region" aria-label="Vision and Commitment">
      <p class="paragraph">
        Throughout my career I have <span class="intro-highlight">designed and managed design systems</span>, not only as a support for visual consistency, but also as a strategic tool to scale products and improve communication between design and development.
      </p>
      <p class="paragraph">
        Beyond design, I enjoy <span class="intro-highlight">project management, mentoring junior designers, and team capacity planning</span>, ensuring that we work in an optimal and impactful way.
      </p>
      <p class="paragraph">
        Outside of work, you’ll find me <span class="intro-highlight">playing sports, gaming, or exploring the latest in technology</span>.
      </p>
    </div>
  </div>
</div>

  </section>

  <!-- Mis valores Section -->
  <section 
    class="section section--with-border" 
    id="my-values"
    role="region"
    aria-labelledby="my-values-title"
  >
    <div class="container">
      <div class="content-block">
        <!-- Título de sección -->
        <Title 
          text="My values"
          size="big"
          showDivider={false}
          as="h2"
          class="section-title"
          id="my-values-title"
        />
        
        <!-- Grid de puntos -->
        <div 
          class="grid grid--responsive-2" 
          role="list"
          aria-label="My 6 main values"
        >
          {misValoresItems.map((item, index) => (
            <div role="listitem">
              <Punto
                number={item.number}
                title={item.title}
                description={item.description}
                titleTag="h3"
                class="slide-up"
                ariaLabel={`Step ${item.number}: ${item.title}`}
              />
            </div>
          ))}
          
          <!-- Último elemento invisible para mantener el grid -->
          {misValoresItems.length % 2 !== 0 && (
            <div class="grid-placeholder" aria-hidden="true"></div>
          )}
        </div>
      </div>
    </div>
  </section>

  <!-- Qué aporto Section -->
  <section 
    class="section section--with-border" 
    id="what-bring"
    role="region"
    aria-labelledby="what-bring-title"
  >
    <div class="container">
      <div class="content-block">
        <!-- Título de sección -->
        <Title 
          text="What I’ll bring to the team"
          size="big"
          showDivider={false}
          as="h2"
          class="section-title"
          id="what-bring-title"
        />
        
        <!-- Grid de puntos sin números -->
        <div 
          class="grid grid--responsive-2"
          role="list" 
          aria-label="What I’ll Bring to the Team"
        >
          {queAportoItems.map((item, index) => (
            <div role="listitem">
              <Punto
                title={item.title}
                description={item.description}
                showNumber={false}
                titleTag="h3"
                class="slide-up"
                ariaLabel={`what I bring: ${item.title}`}
              />
            </div>
          ))}
        </div>
      </div>
    </div>
  </section>

  <!-- Cartas de recomendación Section -->
  <section 
    class="section section--with-border" 
    id="recommendation"
    role="region"
    aria-labelledby="recommendation-title"
  >
    <div class="container">
      <div class="content-block">
        <!-- Título de sección -->
        <Title 
          text="Recommendation Letters"
          size="big"
          showDivider={false}
          as="h2"
          class="section-title"
          id="recommendation-title"
        />
        
        <!-- Grid de cartas -->
        <div 
          class="grid grid--responsive-2"
          role="list"
          aria-label="REcommendation letters"
        >
          {recomendacionItems.map((item, index) => (
            <div role="listitem">
              <RecommendationLetter
                nombre={item.nombre}
                cargo={item.cargo}
                empresa={item.empresa}
                href={getUrl(item.href)}
                linkText={item.linkText}
                target="_blank"
                class="slide-up"
                linkAriaLabel={`Recommendation letter of ${item.nombre}, ${item.cargo} at ${item.empresa}`}
              />
            </div>
          ))}
        </div>
      </div>
    </div>
  </section>

</PageLayout>

<style>
  /* Importar estilos globales de layout */
  @import '../../styles/layout.css';
  
  /* ====================================
     ACCESSIBILITY IMPROVEMENTS
     ==================================== */
  
  /* Screen reader only content */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }
  
  /* ====================================
     ESTILOS ESPECÍFICOS - INTRO SECTION
     ==================================== */
  
  /* Contenedor para cada columna de texto */
   .intro-text {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xl); 
  }
  

  /* Texto destacado en blanco */
  .intro-highlight {
    color: var(--color-text-primary); /* #fefefe */
    font-weight: var(--font-weight-medium); /* Mantiene el mismo peso */
  }
  
  /* ====================================
     ESTILOS ESPECÍFICOS - RESTO DE PÁGINA
     ==================================== */
  
  .section-title {
    margin-bottom: var(--spacing-xl);
  }
  
  .grid-placeholder {
    opacity: 0;
    pointer-events: none;
    min-height: 1px;
  }
  
  /* Animaciones escalonadas */
  .slide-up {
    opacity: 0;
    animation: slideUpStagger 0.8s ease-out forwards;
  }
  
  @keyframes slideUpStagger {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* ====================================
     RESPONSIVE ADJUSTMENTS - Basado en diseños específicos de Figma
     ==================================== */
  
  /* Mobile breakpoint - exacto al diseño de Figma */
  @media (max-width: 767px) {
    /* Skip links en móvil */
    .skip-link {
      font-size: var(--font-size-sm);
      padding: var(--spacing-sm) var(--spacing-md);
    }
    
    
    /* Intro section responsive - mantiene tamaño según diseño mobile */
    .intro-text {
      gap: var(--spacing-lg); /* 16px según mobile spacing */
    }
    
    /* Grids en móvil - una sola columna según diseño */
    .grid--responsive-2 {
      grid-template-columns: 1fr; /* Una columna en móvil */
      gap: var(--spacing-lg); /* 16px según mobile spacing */
    }
    
    /* Content blocks en móvil */
    .content-block {
      gap: var(--spacing-lg); /* 16px según Figma mobile */
    }
    
    /* Títulos de sección en móvil */
    .section-title {
      margin-bottom: var(--spacing-lg); /* 16px según mobile */
    }
  }

  /* No necesitamos breakpoint más pequeño - el diseño mobile cubre hasta 480px */
  
  /* ====================================
     ACCESSIBILITY & MOTION
     ==================================== */
  
  /* Estados de reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .fade-in,
    .slide-up {
      animation: none;
      opacity: 1;
      transform: none;
    }
    
    .skip-link {
      transition: none;
    }
  }

  /* Estados para high contrast */
  @media (prefers-contrast: high) {
    .paragraph {
      color: var(--color-text-primary);
    }
    
    .intro-highlight {
      text-decoration: underline;
      text-decoration-thickness: 2px;
    }
    
    .skip-link {
      border: 3px solid var(--color-text-primary);
    }
  }
  
  /* ====================================
     PRINT STYLES
     ==================================== */
  
  @media print {

    .slide-up,
    .fade-in {
      animation: none;
      opacity: 1;
      transform: none;
    }
    
    .intro-highlight {
      font-weight: var(--font-weight-bold);
      text-decoration: underline;
    }
  }
</style>

<script>
  // Mejoras de accesibilidad en el cliente
  document.addEventListener('astro:page-load', () => {
    // Anunciar cambios de página para screen readers
    const pageTitle = document.title;
    const announcement = document.createElement('div');
    announcement.setAttribute('aria-live', 'polite');
    announcement.setAttribute('aria-atomic', 'true');
    announcement.className = 'sr-only';
    announcement.textContent = `Página cargada: ${pageTitle}`;
    
    document.body.appendChild(announcement);
    
    setTimeout(() => {
      if (document.body.contains(announcement)) {
        document.body.removeChild(announcement);
      }
    }, 1000);

    // Mejorar focus management para skip links
    const skipLinks = document.querySelectorAll('.skip-link');
    skipLinks.forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const href = link.getAttribute('href');
        const targetId = href ? href.substring(1) : '';
        const targetElement = document.getElementById(targetId);
        
        if (targetElement) {
          // Hacer el elemento focusable temporalmente si no lo es
          const originalTabIndex = targetElement.getAttribute('tabindex');
          if (!originalTabIndex) {
            targetElement.setAttribute('tabindex', '-1');
          }
          
          // Focus y scroll al elemento
          targetElement.focus();
          targetElement.scrollIntoView({ 
            behavior: 'smooth', 
            block: 'start' 
          });
          
          // Restaurar tabindex original después del focus
          if (!originalTabIndex) {
            setTimeout(() => {
              targetElement.removeAttribute('tabindex');
            }, 100);
          }
        }
      });
    });

    // Mejorar UX de animaciones según preferencias del usuario
    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    
    if (prefersReducedMotion) {
      // Desactivar todas las animaciones si el usuario prefiere reduced motion
      const animatedElements = document.querySelectorAll('.slide-up, .fade-in');
      animatedElements.forEach(el => {
        const element = el as HTMLElement;
        element.style.animation = 'none';
        element.style.opacity = '1';
        element.style.transform = 'none';
      });
    }
  });
</script>