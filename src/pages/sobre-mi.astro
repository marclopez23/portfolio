---
// src/pages/sobre-mi.astro
import PageLayout from '../layouts/PageLayout.astro';
import Hero from '../components/Hero.astro';
import Title from '../components/Title.astro';
import Punto from '../components/Punto.astro';
import RecommendationLetter from '../components/RecommendationLetter.astro';

const pageTitle = "Sobre mí - Marc López";

// Datos de los puntos "Como trabajo"
const comoTrabajoItems = [
  {
    number: "1",
    title: "Entender y analizar",
    description: "Analizar a fondo las necesidades de los usuarios, el mercado y la idea de negocio o producto."
  },
  {
    number: "2", 
    title: "Idear",
    description: "Trabajar en la concepción de posibles soluciones, definiendo los recorridos (journeys) y esbozando los primeros bocetos."
  },
  {
    number: "3",
    title: "Diseñar", 
    description: "Sumergirse en la creación de la interfaz del producto, desarrollando tanto las pantallas como el sistema de diseño."
  },
  {
    number: "4",
    title: "Testar",
    description: "Realizar pruebas con usuarios para evaluar el trabajo realizado en las etapas previas y determinar la efectividad del diseño."
  },
  {
    number: "5",
    title: "Celebración y mejora continua",
    description: "Reconocer y felicitar al equipo por el excelente trabajo si todo ha salido bien. En caso contrario, identificar áreas de mejora y prepararse para iterar."
  }
];

// Datos de los puntos "Qué aporto"
const queAportoItems = [
  {
    title: "Enlace con desarrollo",
    description: "Me siento muy cómodo hablando con los equipos de desarrollo. Para mí la unión entre diseño y desarrollo es vital para crear un buen producto."
  },
  {
    title: "Calma y tranquilidad", 
    description: "Gestiono muy bien situaciones complejas o de estrés."
  },
  {
    title: "Colaboración",
    description: "Me encanta trabajar en equipo y realizar todo tipo de actividades en grupo."
  },
  {
    title: "Consejos",
    description: "Intento aprender algo nuevo cada día y si veo que puede ser útil para el equipo lo comparto con ellos."
  }
];

// Datos de las cartas de recomendación
const recomendacionItems = [
  {
    nombre: "Mauricio Alpizar",
    cargo: "Senior Product Designer",
    empresa: "K-LAGAN",
    href: "/cartas/mauricio-alpizar.pdf",
    linkText: "Leer carta de recomendación"
  },
  {
    nombre: "Eszter Vass",
    cargo: "Principal Product Management in Custody Banking",
    empresa: "Epsom", 
    href: "/cartas/eszter-vass.pdf",
    linkText: "Leer carta de recomendación"
  }
];
---

<PageLayout 
  title={pageTitle}
  currentPage="/sobre-mi"
  description="Conoce más sobre Marc López, diseñador UX/UI especializado en crear experiencias digitales centradas en el usuario."
  keywords="sobre mi, marc lopez, diseñador ux ui, experiencia usuario, portfolio"
>

  <!-- Hero Section -->
  <section role="banner" aria-labelledby="hero-title">
      <Hero 
        title="Sobre mí"
        titleTag="h1"
        class="fade-in"
        id="hero-title"
      />
  </section>

  <!-- Intro Section -->
  <section 
    class="section section--with-border" 
    id="intro"
    role="main"
    aria-labelledby="intro-heading"
  >
    <div class="container">
      <!-- Heading invisible para screen readers -->
      <h2 id="intro-heading" class="sr-only">Introducción personal</h2>
      
      <div class="text-columns">
        <!-- Columna izquierda -->
        <div class="intro-text" role="region" aria-label="Filosofía de trabajo">
          <p class="paragraph">
            Mi proceso creativo abarca desde la <span class="intro-highlight">concepción inicial hasta la entrega final al equipo de desarrollo</span>, siempre con el usuario en el centro.
          <p class="paragraph">
            A lo largo de mi trayectoria he aprendido que el éxito radica en comprender las necesidades de las personas, alcanzar los objetivos del negocio y crear productos accesibles que generen impacto real.
          </p>
        </div>
        
        <!-- Columna derecha -->
        <div class="intro-text" role="region" aria-label="Visión y compromiso">
          <p class="paragraph">
            Para mí, el diseño no es solo una cuestión estética o de tendencias: <span class="intro-highlight">es la oportunidad de dar forma a soluciones significativas que inspiren y empoderen</span>.
          </p>
          <p class="paragraph">
            Estoy comprometido a seguir desafiando los límites del diseño y a liderar el camino hacia un <span class="intro-highlight">futuro digital más inclusivo y emocionante</span>.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Como trabajo Section -->
  <section 
    class="section section--with-border" 
    id="como-trabajo"
    role="region"
    aria-labelledby="como-trabajo-title"
  >
    <div class="container">
      <div class="content-block">
        <!-- Título de sección -->
        <Title 
          text="Mi proceso de trabajo"
          size="big"
          showDivider={false}
          as="h2"
          class="section-title"
          id="como-trabajo-title"
        />
        
        <!-- Grid de puntos -->
        <div 
          class="grid grid--responsive-2" 
          role="list"
          aria-label="Proceso de trabajo en 5 pasos"
        >
          {comoTrabajoItems.map((item, index) => (
            <div role="listitem">
              <Punto
                number={item.number}
                title={item.title}
                description={item.description}
                titleTag="h3"
                class="slide-up"
                ariaLabel={`Paso ${item.number}: ${item.title}`}
              />
            </div>
          ))}
          
          <!-- Último elemento invisible para mantener el grid -->
          {comoTrabajoItems.length % 2 !== 0 && (
            <div class="grid-placeholder" aria-hidden="true"></div>
          )}
        </div>
      </div>
    </div>
  </section>

  <!-- Qué aporto Section -->
  <section 
    class="section section--with-border" 
    id="que-aporto"
    role="region"
    aria-labelledby="que-aporto-title"
  >
    <div class="container">
      <div class="content-block">
        <!-- Título de sección -->
        <Title 
          text="Qué aportaré al equipo"
          size="big"
          showDivider={false}
          as="h2"
          class="section-title"
          id="que-aporto-title"
        />
        
        <!-- Grid de puntos sin números -->
        <div 
          class="grid grid--responsive-2"
          role="list" 
          aria-label="Habilidades y aportes al equipo"
        >
          {queAportoItems.map((item, index) => (
            <div role="listitem">
              <Punto
                title={item.title}
                description={item.description}
                showNumber={false}
                titleTag="h3"
                class="slide-up"
                ariaLabel={`Aporte: ${item.title}`}
              />
            </div>
          ))}
        </div>
      </div>
    </div>
  </section>

  <!-- Cartas de recomendación Section -->
  <section 
    class="section section--with-border" 
    id="recomendaciones"
    role="region"
    aria-labelledby="recomendaciones-title"
  >
    <div class="container">
      <div class="content-block">
        <!-- Título de sección -->
        <Title 
          text="Cartas de recomendación"
          size="big"
          showDivider={false}
          as="h2"
          class="section-title"
          id="recomendaciones-title"
        />
        
        <!-- Grid de cartas -->
        <div 
          class="grid grid--responsive-2"
          role="list"
          aria-label="Cartas de recomendación profesional"
        >
          {recomendacionItems.map((item, index) => (
            <div role="listitem">
              <RecommendationLetter
                nombre={item.nombre}
                cargo={item.cargo}
                empresa={item.empresa}
                href={item.href}
                linkText={item.linkText}
                target="_blank"
                class="slide-up"
                linkAriaLabel={`Carta de recomendación de ${item.nombre}, ${item.cargo} en ${item.empresa}`}
              />
            </div>
          ))}
        </div>
      </div>
    </div>
  </section>

</PageLayout>

<style>
  /* Importar estilos globales de layout */
  @import '../styles/layout.css';
  
  /* ====================================
     ACCESSIBILITY IMPROVEMENTS
     ==================================== */
  
  /* Screen reader only content */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }
  
  /* ====================================
     ESTILOS ESPECÍFICOS - INTRO SECTION
     ==================================== */
  
  /* Contenedor para cada columna de texto */
  .intro-text {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-2xl); /* 32px entre párrafos */
  }
  

  /* Texto destacado en blanco */
  .intro-highlight {
    color: var(--color-text-primary); /* #fefefe */
    font-weight: var(--font-weight-medium); /* Mantiene el mismo peso */
  }
  
  /* ====================================
     ESTILOS ESPECÍFICOS - RESTO DE PÁGINA
     ==================================== */
  
  .section-title {
    margin-bottom: var(--spacing-xl);
  }
  
  .grid-placeholder {
    opacity: 0;
    pointer-events: none;
    min-height: 1px;
  }
  
  /* Animaciones escalonadas */
  .slide-up {
    opacity: 0;
    animation: slideUpStagger 0.8s ease-out forwards;
  }
  
  @keyframes slideUpStagger {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* ====================================
     RESPONSIVE ADJUSTMENTS - Basado en diseños específicos de Figma
     ==================================== */
  
  /* Mobile breakpoint - exacto al diseño de Figma */
  @media (max-width: 767px) {
    /* Skip links en móvil */
    .skip-link {
      font-size: var(--font-size-sm);
      padding: var(--spacing-sm) var(--spacing-md);
    }
    
    
    /* Intro section responsive - mantiene tamaño según diseño mobile */
    .intro-text {
      gap: var(--spacing-lg); /* 16px según mobile spacing */
    }
    
    /* Grids en móvil - una sola columna según diseño */
    .grid--responsive-2 {
      grid-template-columns: 1fr; /* Una columna en móvil */
      gap: var(--spacing-lg); /* 16px según mobile spacing */
    }
    
    /* Content blocks en móvil */
    .content-block {
      gap: var(--spacing-lg); /* 16px según Figma mobile */
    }
    
    /* Títulos de sección en móvil */
    .section-title {
      margin-bottom: var(--spacing-lg); /* 16px según mobile */
    }
  }

  /* No necesitamos breakpoint más pequeño - el diseño mobile cubre hasta 480px */
  
  /* ====================================
     ACCESSIBILITY & MOTION
     ==================================== */
  
  /* Estados de reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .fade-in,
    .slide-up {
      animation: none;
      opacity: 1;
      transform: none;
    }
    
    .skip-link {
      transition: none;
    }
  }

  /* Estados para high contrast */
  @media (prefers-contrast: high) {
    .paragraph {
      color: var(--color-text-primary);
    }
    
    .intro-highlight {
      text-decoration: underline;
      text-decoration-thickness: 2px;
    }
    
    .skip-link {
      border: 3px solid var(--color-text-primary);
    }
  }
  
  /* ====================================
     PRINT STYLES
     ==================================== */
  
  @media print {

    .slide-up,
    .fade-in {
      animation: none;
      opacity: 1;
      transform: none;
    }
    
    .intro-highlight {
      font-weight: var(--font-weight-bold);
      text-decoration: underline;
    }
  }
</style>

<script>
  // Mejoras de accesibilidad en el cliente
  document.addEventListener('astro:page-load', () => {
    // Anunciar cambios de página para screen readers
    const pageTitle = document.title;
    const announcement = document.createElement('div');
    announcement.setAttribute('aria-live', 'polite');
    announcement.setAttribute('aria-atomic', 'true');
    announcement.className = 'sr-only';
    announcement.textContent = `Página cargada: ${pageTitle}`;
    
    document.body.appendChild(announcement);
    
    setTimeout(() => {
      if (document.body.contains(announcement)) {
        document.body.removeChild(announcement);
      }
    }, 1000);

    // Mejorar focus management para skip links
    const skipLinks = document.querySelectorAll('.skip-link');
    skipLinks.forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const href = link.getAttribute('href');
        const targetId = href ? href.substring(1) : '';
        const targetElement = document.getElementById(targetId);
        
        if (targetElement) {
          // Hacer el elemento focusable temporalmente si no lo es
          const originalTabIndex = targetElement.getAttribute('tabindex');
          if (!originalTabIndex) {
            targetElement.setAttribute('tabindex', '-1');
          }
          
          // Focus y scroll al elemento
          targetElement.focus();
          targetElement.scrollIntoView({ 
            behavior: 'smooth', 
            block: 'start' 
          });
          
          // Restaurar tabindex original después del focus
          if (!originalTabIndex) {
            setTimeout(() => {
              targetElement.removeAttribute('tabindex');
            }, 100);
          }
        }
      });
    });

    // Mejorar UX de animaciones según preferencias del usuario
    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    
    if (prefersReducedMotion) {
      // Desactivar todas las animaciones si el usuario prefiere reduced motion
      const animatedElements = document.querySelectorAll('.slide-up, .fade-in');
      animatedElements.forEach(el => {
        const element = el as HTMLElement;
        element.style.animation = 'none';
        element.style.opacity = '1';
        element.style.transform = 'none';
      });
    }
  });
</script>